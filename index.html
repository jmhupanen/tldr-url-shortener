<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <title>TLDR - URL Shortener</title>
    <link 
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" 
      rel="stylesheet"
      integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" 
      crossorigin="anonymous"
    />
    <script type="text/javascript">
      const shorten = async () => {
        const url = document.getElementById("urlInput").value;
        const response = await fetch(location.origin + '/api/shorten', {
          method: 'POST',
          headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ "origUrl": url })
        })
        .then(response => response.json())
        .then(response => {
          console.log(JSON.stringify(response));
          document.getElementById("urlInput").value = "";
          document.getElementById("originalLinkTitle").style.visibility = "visible";
          document.getElementById("shortLinkTitle").style.visibility = "visible";
          document.getElementById("originalLink").innerHTML = response.url;
          document.getElementById("shortLink").innerHTML = `${location.origin}/${response.id}`;
        });
      };
    </script>
  </head>

  <body>
    <div class="container">
      <div class="row">
        <div class="col">
          <h1 class="text-center">TLDR</h1>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <p class="text-center">The greatest URL shortener ever</p>
        </div>
      </div>
      <div class="row">
        <div class="col justify-content-center input-group">
          <input 
            type="url" 
            class="form-control" 
            placeholder="https://example.com" 
            aria-label="URL to be shortened" 
            aria-describedby="basic-addon2" 
            id="urlInput"
          >
          <div class="input-group-append">
            <button type="button" class="btn btn-primary" onclick="shorten()">TLDRize</button>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <p style="visibility:hidden;" class="text-center" id="originalLinkTitle">Original link: </p>
          <p class="text-center" id="originalLink"></p>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <p style="visibility:hidden;" class="text-center" id="shortLinkTitle">Short link: </p>
          <p class="text-center" id="shortLink"></p>
        </div>
      </div>
    </div>
    <script 
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" 
      integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" 
      crossorigin="anonymous"
    ></script>
  </body>

</html>